name: A-Share Daily Scan

# 触发条件
on:
  # 1. 定时触发：UTC时间每天 08:30 (北京时间 16:30，收盘后)
  schedule:
    - cron: '30 8 * * *'
  # 2. 手动触发：在 GitHub Actions 页面点击按钮运行
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    # 设置时区为上海，确保生成的文件名日期正确
    env:
      TZ: Asia/Shanghai

    steps:
    # 第一步：拉取你的代码
    - name: Checkout code
      uses: actions/checkout@v3

    # 第二步：搭建 Python 环境
    - name: Set up Python 3.9
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    # 第三步：安装依赖库
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    # 第四步：运行你的选股脚本
    # 假设你的脚本文件名叫 main.py，如果叫别的名字请修改这里
    - name: Run Alpha Galaxy Strategy
      run: main.py

    # 第五步：上传生成的 Excel 文件作为“构建产物” (Artifact)
    # 这样运行结束后，你可以在 Actions 页面下载这个文件，而不是存回代码库
    - name: Upload Excel Report
      uses: actions/upload-artifact@v3
      with:
        name: Stock-Report-${{ github.run_id }}
        path: ./*.xlsx
        retention-days: 7  # 文件保留7天
